<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ topic.title }}</title>
  <base href="https://nga.178.com" />
  <link rel="stylesheet" href="{{ contextPath }}/html/common.css" />
  <link rel="stylesheet" href="{{ contextPath }}/html/topic.css" />
</head>

<body>
  <div class="container">
    <!-- Ê†áÈ¢ò -->
    <div class="topic-header">
      <h1><a href="/read.php?tid={{ topic.id }}">{{ topic.title }}</a></h1>
      <!-- <img src="{{authorAvatar}}" alt="avatar" /> -->
    </div>

    <!-- ‰ΩúËÄÖ„ÄÅÊó∂Èó¥ -->
    <div class="topic-meta">
      <a class="node" href="/thread.php?fid={{ topic.node.name }}">{{ topic.node.title }}</a>
      <a class="user text-bold" href="/nuke.php?func=ucp&uid={{ topic.authorID }}">{{ topic.authorName }}</a>
      <span class="time"> {{ topic.displayTime }} </span>
      {{if topic.onlyAuthor}}
      <a id="cancelOnlyAuthor" class="onlyAuthor" href="javascript:;" onclick="vsPostMessage('cancelOnlyAuthor');" title="ÂèñÊ∂àÂè™ÁúãÊ•º‰∏ª">ÂèñÊ∂àÂè™ÁúãÊ•º‰∏ª</a>
      {{else}}
      <a id="onlyAuthor"  class="onlyAuthor" href="javascript:;" onclick="vsPostMessage('onlyAuthor');" title="Âè™ÁúãÊ•º‰∏ª">Âè™ÁúãÊ•º‰∏ª</a>
      {{/if}}
    </div>
    <hr />

    <!-- Ê≠£Êñá -->
    {{if topic.content}}
    <div class="topic-content">{{@ topic.content}}</div>
    {{else}}
    <div class="topic-content">Ê≠£ÊñáÊó†ÂÜÖÂÆπ</div>
    {{/if}}

    {{ if topic.comments.length }}
    <hr />
    <p>Ë¥¥Êù°</p>
    <div class="comments">
      {{ each topic.comments }}
      <div class="comments-detail">
        {{$value.authorName}}Ôºö{{@ $value.content}}
      </div>
      <br />
      {{ /each }}
    </div>
    {{ /if }}


    <div class="topic-toolbar">
      <a class="op refresh" href="javascript:;" onclick="vsPostMessage('refresh', {page: <%= topic.pageNow %>});" title="Âà∑Êñ∞È°µÈù¢">Âà∑Êñ∞È°µÈù¢</a>
      <span class="text count">
        {{topic.likes}} üëç
      </span>
    </div>

    <hr />

    <!-- ËØÑËÆ∫ -->
    <div class="reply">
      {{if topic.replies.length}}
      <h2>ÂÖ± {{ topic.replyCount }} Êù°ÂõûÂ§ç</h2>
      {{else}}
      <h2>ÊöÇÊó†ÂõûÂ§ç</h2>
      {{/if}}

      <!-- ÂàóË°® -->
      {{each topic.replies}}
      <div class="reply-item">
        <!-- <img class="avatar" src="{{$value.userAvatar}}" alt="" /> -->
        <div class="reply-item-wrap">
          <div class="meta">
            <a class="user {{ topic.authorName === $value.userName ? 'user--author' : '' }}"
              href="/nuke.php?func=ucp&uid={{ $value.uid }}">{{ $value.userName }}</a>
            <span class="time">{{ $value.time }}</span>
            <span class="thanks">üëç {{ $value.likes }}</span>
            <span class="floor">{{ $value.floor }}</span>
          </div>
          {{ if $value.quote }}
          <div class="quote-url">
            <a href="/nuke.php?func=ucp&uid={{ $value.quoteuid }}">{{ $value.quoteuname }}</a>
          </div>
          <blockquote>
            {{@ $value.quote }}
          </blockquote>
          {{ /if }}
          <div class="topic-content">{{@ $value.content}}</div>
          {{ if $value.comments.length }}
          <hr />
          <p>Ë¥¥Êù°</p>
          <div class="comments">
            {{ each $value.comments }}
            <div class="comments-detail">
              {{ $value.authorName }}Ôºö{{@ $value.content }}
            </div>
            {{ /each }}
          </div>
          {{ /if }}
        </div>
      </div>
      <hr />
      {{/each}}
    </div>

    {{if !topic.onlyAuthor && topic.needTurn}}
      {{if topic.pageNow > 1}}
      <a class="pageUp" href="javascript:;" onclick="vsPostMessage('pageTurning', {page: <%= topic.pageNow-1 %>});" title="‰∏ä‰∏ÄÈ°µ">‰∏ä‰∏ÄÈ°µ</a>
      <a class="pageDown" href="javascript:;" onclick="vsPostMessage('pageTurning', {page: <%= topic.pageNow+1 %>});" title="‰∏ã‰∏ÄÈ°µ">‰∏ã‰∏ÄÈ°µ</a>
      {{else}}
      <a class="pageDown" href="javascript:;" onclick="vsPostMessage('pageTurning', {page: <%= topic.pageNow+1 %>});" title="‰∏ã‰∏ÄÈ°µ">‰∏ã‰∏ÄÈ°µ</a>
      {{/if}}
      <hr />
    {{/if}}
    
    {{if !topic.onlyAuthor}}
    <div class="pages">
    <% for(var i = 1; i <= topic.pages; i++){ %>
      <% if (i == topic.pageNow) {%>
      <b>Á¨¨<%- i %>È°µ</b>
      <%} else {%>
      <a href="javascript:;" onclick="vsPostMessage('pageTurning', {page: <%- i %>});"><%- i %></a>
      <%}%>
    <% } %>
    </div>
    {{/if}}

  </div>

  <script src="{{ contextPath }}/html/lib/js-yaml.min.js"></script>
  <script>
    var __topic = topic;
  </script>
  <script src="{{ contextPath }}/html/topic.js"></script>
  <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>
</body>

</html>